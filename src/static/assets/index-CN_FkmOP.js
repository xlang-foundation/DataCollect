import{g as R,u as T,a as z,d as I}from"./label-D7GGsh-a.js";import{d as U,v as n,o as q,k as A,i as g,y as O,g as l,a as t,B as i,Q,c as S,p as c,D as _,R as j,f as k,_ as G}from"./index-D6AMwTYj.js";import"./request-DdvWjchG.js";const H={class:"label-container"},J={class:"header"},K=U({__name:"index",setup(P){const m=n(!1),v=n(!1),r=n(!1),f=n(!1),y=n([]),d=n(),o=n({id:0,label:""}),w={label:[{required:!0,message:"请输入标签名称",trigger:"blur"}]},p=async()=>{try{m.value=!0;const a=await R();y.value=a}catch(a){console.error("Failed to fetch labels:",a)}finally{m.value=!1}},x=()=>{f.value=!1,o.value={id:0,label:""},r.value=!0},C=a=>{f.value=!0,o.value={...a},r.value=!0},V=async()=>{d.value&&await d.value.validate(async a=>{if(a)try{v.value=!0,f.value?(await T(o.value.id,o.value.label),_.success("更新成功")):(await z(o.value.label),_.success("添加成功")),r.value=!1,p()}catch(e){console.error("Operation failed:",e)}finally{v.value=!1}})},L=async a=>{try{await j.confirm(`确定要删除标签 "${a.label}" 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await I(a.id),_.success("删除成功"),p()}catch(e){e!=="cancel"&&console.error("Failed to delete label:",e)}},B=()=>{d.value&&d.value.resetFields()};return q(()=>{p()}),(a,e)=>{const u=i("el-button"),b=i("el-table-column"),D=i("el-table"),E=i("el-input"),F=i("el-form-item"),$=i("el-form"),h=i("el-dialog"),M=Q("loading");return k(),A("div",H,[g("div",J,[e[4]||(e[4]=g("h2",null,"标签管理",-1)),l(u,{type:"primary",onClick:x},{default:t(()=>e[3]||(e[3]=[c("添加标签")])),_:1})]),O((k(),S(D,{data:y.value,border:"",style:{width:"100%"}},{default:t(()=>[l(b,{prop:"id",label:"ID",width:"80"}),l(b,{prop:"label",label:"标签名称"}),l(b,{label:"操作",width:"200"},{default:t(({row:s})=>[l(u,{type:"primary",size:"small",onClick:N=>C(s)},{default:t(()=>e[5]||(e[5]=[c(" 编辑 ")])),_:2},1032,["onClick"]),l(u,{type:"danger",size:"small",onClick:N=>L(s)},{default:t(()=>e[6]||(e[6]=[c(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[M,m.value]]),l(h,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=s=>r.value=s),title:f.value?"编辑标签":"添加标签",width:"500px",onClose:B},{footer:t(()=>[l(u,{onClick:e[1]||(e[1]=s=>r.value=!1)},{default:t(()=>e[7]||(e[7]=[c("取消")])),_:1}),l(u,{type:"primary",onClick:V,loading:v.value},{default:t(()=>e[8]||(e[8]=[c(" 确定 ")])),_:1},8,["loading"])]),default:t(()=>[l($,{ref_key:"formRef",ref:d,model:o.value,rules:w,"label-width":"100px"},{default:t(()=>[l(F,{label:"标签名称",prop:"label"},{default:t(()=>[l(E,{modelValue:o.value.label,"onUpdate:modelValue":e[0]||(e[0]=s=>o.value.label=s)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),Z=G(K,[["__scopeId","data-v-377d8c64"]]);export{Z as default};
