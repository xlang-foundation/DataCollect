import{q as Te,s as cn,d as ln,v as oe,o as lt,x as fn,w as dn,k as se,i as O,y as ft,g as U,z as dt,u as de,A as vn,B as he,t as ue,a as H,F as ze,l as Ye,C as hn,D as ne,G as mn,p as me,H as gn,I as pn,J as yn,K as _n,L as bn,e as wn,f as ce,M as Ae,_ as In}from"./index-DHxyzi4q.js";import{g as En}from"./label-BIKFXkvN.js";import{s as Sn}from"./request-CtLJyfLT.js";const j=[];for(let E=0;E<256;++E)j.push((E+256).toString(16).slice(1));function Dn(E,B=0){return(j[E[B+0]]+j[E[B+1]]+j[E[B+2]]+j[E[B+3]]+"-"+j[E[B+4]]+j[E[B+5]]+"-"+j[E[B+6]]+j[E[B+7]]+"-"+j[E[B+8]]+j[E[B+9]]+"-"+j[E[B+10]]+j[E[B+11]]+j[E[B+12]]+j[E[B+13]]+j[E[B+14]]+j[E[B+15]]).toLowerCase()}let Ve;const Rn=new Uint8Array(16);function xn(){if(!Ve){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Ve=crypto.getRandomValues.bind(crypto)}return Ve(Rn)}const Tn=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),vt={randomUUID:Tn};function ht(E,B,W){var S;if(vt.randomUUID&&!E)return vt.randomUUID();E=E||{};const A=E.random??((S=E.rng)==null?void 0:S.call(E))??xn();if(A.length<16)throw new Error("Random bytes length must be >= 16");return A[6]=A[6]&15|64,A[8]=A[8]&63|128,Dn(A)}function Ce(E){throw new Error('Could not dynamically require "'+E+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var We={exports:{}};/*!
    localForage -- Offline Storage, Improved
    Version 1.10.0
    https://localforage.github.io/localForage
    (c) 2013-2017 Mozilla, Apache License 2.0
*/var mt;function An(){return mt||(mt=1,function(E,B){(function(W){E.exports=W()})(function(){return function W(A,S,_){function L(C,z){if(!S[C]){if(!A[C]){var v=typeof Ce=="function"&&Ce;if(!z&&v)return v(C,!0);if(p)return p(C,!0);var y=new Error("Cannot find module '"+C+"'");throw y.code="MODULE_NOT_FOUND",y}var P=S[C]={exports:{}};A[C][0].call(P.exports,function(F){var K=A[C][1][F];return L(K||F)},P,P.exports,W,A,S,_)}return S[C].exports}for(var p=typeof Ce=="function"&&Ce,k=0;k<_.length;k++)L(_[k]);return L}({1:[function(W,A,S){(function(_){var L=_.MutationObserver||_.WebKitMutationObserver,p;if(L){var k=0,C=new L(F),z=_.document.createTextNode("");C.observe(z,{characterData:!0}),p=function(){z.data=k=++k%2}}else if(!_.setImmediate&&typeof _.MessageChannel<"u"){var v=new _.MessageChannel;v.port1.onmessage=F,p=function(){v.port2.postMessage(0)}}else"document"in _&&"onreadystatechange"in _.document.createElement("script")?p=function(){var M=_.document.createElement("script");M.onreadystatechange=function(){F(),M.onreadystatechange=null,M.parentNode.removeChild(M),M=null},_.document.documentElement.appendChild(M)}:p=function(){setTimeout(F,0)};var y,P=[];function F(){y=!0;for(var M,te,Y=P.length;Y;){for(te=P,P=[],M=-1;++M<Y;)te[M]();Y=P.length}y=!1}A.exports=K;function K(M){P.push(M)===1&&!y&&p()}}).call(this,typeof Te<"u"?Te:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(W,A,S){var _=W(1);function L(){}var p={},k=["REJECTED"],C=["FULFILLED"],z=["PENDING"];A.exports=v;function v(l){if(typeof l!="function")throw new TypeError("resolver must be a function");this.state=z,this.queue=[],this.outcome=void 0,l!==L&&K(this,l)}v.prototype.catch=function(l){return this.then(null,l)},v.prototype.then=function(l,D){if(typeof l!="function"&&this.state===C||typeof D!="function"&&this.state===k)return this;var w=new this.constructor(L);if(this.state!==z){var R=this.state===C?l:D;P(w,R,this.outcome)}else this.queue.push(new y(w,l,D));return w};function y(l,D,w){this.promise=l,typeof D=="function"&&(this.onFulfilled=D,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}y.prototype.callFulfilled=function(l){p.resolve(this.promise,l)},y.prototype.otherCallFulfilled=function(l){P(this.promise,this.onFulfilled,l)},y.prototype.callRejected=function(l){p.reject(this.promise,l)},y.prototype.otherCallRejected=function(l){P(this.promise,this.onRejected,l)};function P(l,D,w){_(function(){var R;try{R=D(w)}catch(f){return p.reject(l,f)}R===l?p.reject(l,new TypeError("Cannot resolve promise with itself")):p.resolve(l,R)})}p.resolve=function(l,D){var w=M(F,D);if(w.status==="error")return p.reject(l,w.value);var R=w.value;if(R)K(l,R);else{l.state=C,l.outcome=D;for(var f=-1,g=l.queue.length;++f<g;)l.queue[f].callFulfilled(D)}return l},p.reject=function(l,D){l.state=k,l.outcome=D;for(var w=-1,R=l.queue.length;++w<R;)l.queue[w].callRejected(D);return l};function F(l){var D=l&&l.then;if(l&&(typeof l=="object"||typeof l=="function")&&typeof D=="function")return function(){D.apply(l,arguments)}}function K(l,D){var w=!1;function R(b){w||(w=!0,p.reject(l,b))}function f(b){w||(w=!0,p.resolve(l,b))}function g(){D(f,R)}var h=M(g);h.status==="error"&&R(h.value)}function M(l,D){var w={};try{w.value=l(D),w.status="success"}catch(R){w.status="error",w.value=R}return w}v.resolve=te;function te(l){return l instanceof this?l:p.resolve(new this(L),l)}v.reject=Y;function Y(l){var D=new this(L);return p.reject(D,l)}v.all=ge;function ge(l){var D=this;if(Object.prototype.toString.call(l)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=l.length,R=!1;if(!w)return this.resolve([]);for(var f=new Array(w),g=0,h=-1,b=new this(L);++h<w;)N(l[h],h);return b;function N(G,X){D.resolve(G).then(q,function(Q){R||(R=!0,p.reject(b,Q))});function q(Q){f[X]=Q,++g===w&&!R&&(R=!0,p.resolve(b,f))}}}v.race=re;function re(l){var D=this;if(Object.prototype.toString.call(l)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=l.length,R=!1;if(!w)return this.resolve([]);for(var f=-1,g=new this(L);++f<w;)h(l[f]);return g;function h(b){D.resolve(b).then(function(N){R||(R=!0,p.resolve(g,N))},function(N){R||(R=!0,p.reject(g,N))})}}},{1:1}],3:[function(W,A,S){(function(_){typeof _.Promise!="function"&&(_.Promise=W(2))}).call(this,typeof Te<"u"?Te:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(W,A,S){var _=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function L(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function p(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}var k=p();function C(){try{if(!k||!k.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),n=typeof fetch=="function"&&fetch.toString().indexOf("[native code")!==-1;return(!e||n)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}function z(e,n){e=e||[],n=n||{};try{return new Blob(e,n)}catch(r){if(r.name!=="TypeError")throw r;for(var t=typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder,o=new t,a=0;a<e.length;a+=1)o.append(e[a]);return o.getBlob(n.type)}}typeof Promise>"u"&&W(3);var v=Promise;function y(e,n){n&&e.then(function(t){n(null,t)},function(t){n(t)})}function P(e,n,t){typeof n=="function"&&e.then(n),typeof t=="function"&&e.catch(t)}function F(e){return typeof e!="string"&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function K(){if(arguments.length&&typeof arguments[arguments.length-1]=="function")return arguments[arguments.length-1]}var M="local-forage-detect-blob-support",te=void 0,Y={},ge=Object.prototype.toString,re="readonly",l="readwrite";function D(e){for(var n=e.length,t=new ArrayBuffer(n),o=new Uint8Array(t),a=0;a<n;a++)o[a]=e.charCodeAt(a);return t}function w(e){return new v(function(n){var t=e.transaction(M,l),o=z([""]);t.objectStore(M).put(o,"key"),t.onabort=function(a){a.preventDefault(),a.stopPropagation(),n(!1)},t.oncomplete=function(){var a=navigator.userAgent.match(/Chrome\/(\d+)/),r=navigator.userAgent.match(/Edge\//);n(r||!a||parseInt(a[1],10)>=43)}}).catch(function(){return!1})}function R(e){return typeof te=="boolean"?v.resolve(te):w(e).then(function(n){return te=n,te})}function f(e){var n=Y[e.name],t={};t.promise=new v(function(o,a){t.resolve=o,t.reject=a}),n.deferredOperations.push(t),n.dbReady?n.dbReady=n.dbReady.then(function(){return t.promise}):n.dbReady=t.promise}function g(e){var n=Y[e.name],t=n.deferredOperations.pop();if(t)return t.resolve(),t.promise}function h(e,n){var t=Y[e.name],o=t.deferredOperations.pop();if(o)return o.reject(n),o.promise}function b(e,n){return new v(function(t,o){if(Y[e.name]=Y[e.name]||pe(),e.db)if(n)f(e),e.db.close();else return t(e.db);var a=[e.name];n&&a.push(e.version);var r=k.open.apply(k,a);n&&(r.onupgradeneeded=function(i){var s=r.result;try{s.createObjectStore(e.storeName),i.oldVersion<=1&&s.createObjectStore(M)}catch(u){if(u.name==="ConstraintError")console.warn('The database "'+e.name+'" has been upgraded from version '+i.oldVersion+" to version "+i.newVersion+', but the storage "'+e.storeName+'" already exists.');else throw u}}),r.onerror=function(i){i.preventDefault(),o(r.error)},r.onsuccess=function(){var i=r.result;i.onversionchange=function(s){s.target.close()},t(i),g(e)}})}function N(e){return b(e,!1)}function G(e){return b(e,!0)}function X(e,n){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version<e.db.version,a=e.version>e.db.version;if(o&&(e.version!==n&&console.warn('The database "'+e.name+`" can't be downgraded from version `+e.db.version+" to version "+e.version+"."),e.version=e.db.version),a||t){if(t){var r=e.db.version+1;r>e.version&&(e.version=r)}return!0}return!1}function q(e){return new v(function(n,t){var o=new FileReader;o.onerror=t,o.onloadend=function(a){var r=btoa(a.target.result||"");n({__local_forage_encoded_blob:!0,data:r,type:e.type})},o.readAsBinaryString(e)})}function Q(e){var n=D(atob(e.data));return z([n],{type:e.type})}function le(e){return e&&e.__local_forage_encoded_blob}function we(e){var n=this,t=n._initReady().then(function(){var o=Y[n._dbInfo.name];if(o&&o.dbReady)return o.dbReady});return P(t,e,e),t}function Ie(e){f(e);for(var n=Y[e.name],t=n.forages,o=0;o<t.length;o++){var a=t[o];a._dbInfo.db&&(a._dbInfo.db.close(),a._dbInfo.db=null)}return e.db=null,N(e).then(function(r){return e.db=r,X(e)?G(e):r}).then(function(r){e.db=n.db=r;for(var i=0;i<t.length;i++)t[i]._dbInfo.db=r}).catch(function(r){throw h(e,r),r})}function Z(e,n,t,o){o===void 0&&(o=1);try{var a=e.db.transaction(e.storeName,n);t(null,a)}catch(r){if(o>0&&(!e.db||r.name==="InvalidStateError"||r.name==="NotFoundError"))return v.resolve().then(function(){if(!e.db||r.name==="NotFoundError"&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),G(e)}).then(function(){return Ie(e).then(function(){Z(e,n,t,o-1)})}).catch(t);t(r)}}function pe(){return{forages:[],db:null,dbReady:null,deferredOperations:[]}}function Ee(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=e[o];var a=Y[t.name];a||(a=pe(),Y[t.name]=a),a.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=we);var r=[];function i(){return v.resolve()}for(var s=0;s<a.forages.length;s++){var u=a.forages[s];u!==n&&r.push(u._initReady().catch(i))}var c=a.forages.slice(0);return v.all(r).then(function(){return t.db=a.db,N(t)}).then(function(d){return t.db=d,X(t,n._defaultConfig.version)?G(t):d}).then(function(d){t.db=a.db=d,n._dbInfo=t;for(var m=0;m<c.length;m++){var I=c[m];I!==n&&(I._dbInfo.db=t.db,I._dbInfo.version=t.version)}})}function Se(e,n){var t=this;e=F(e);var o=new v(function(a,r){t.ready().then(function(){Z(t._dbInfo,re,function(i,s){if(i)return r(i);try{var u=s.objectStore(t._dbInfo.storeName),c=u.get(e);c.onsuccess=function(){var d=c.result;d===void 0&&(d=null),le(d)&&(d=Q(d)),a(d)},c.onerror=function(){r(c.error)}}catch(d){r(d)}})}).catch(r)});return y(o,n),o}function De(e,n){var t=this,o=new v(function(a,r){t.ready().then(function(){Z(t._dbInfo,re,function(i,s){if(i)return r(i);try{var u=s.objectStore(t._dbInfo.storeName),c=u.openCursor(),d=1;c.onsuccess=function(){var m=c.result;if(m){var I=m.value;le(I)&&(I=Q(I));var x=e(I,m.key,d++);x!==void 0?a(x):m.continue()}else a()},c.onerror=function(){r(c.error)}}catch(m){r(m)}})}).catch(r)});return y(o,n),o}function J(e,n,t){var o=this;e=F(e);var a=new v(function(r,i){var s;o.ready().then(function(){return s=o._dbInfo,ge.call(n)==="[object Blob]"?R(s.db).then(function(u){return u?n:q(n)}):n}).then(function(u){Z(o._dbInfo,l,function(c,d){if(c)return i(c);try{var m=d.objectStore(o._dbInfo.storeName);u===null&&(u=void 0);var I=m.put(u,e);d.oncomplete=function(){u===void 0&&(u=null),r(u)},d.onabort=d.onerror=function(){var x=I.error?I.error:I.transaction.error;i(x)}}catch(x){i(x)}})}).catch(i)});return y(a,t),a}function fe(e,n){var t=this;e=F(e);var o=new v(function(a,r){t.ready().then(function(){Z(t._dbInfo,l,function(i,s){if(i)return r(i);try{var u=s.objectStore(t._dbInfo.storeName),c=u.delete(e);s.oncomplete=function(){a()},s.onerror=function(){r(c.error)},s.onabort=function(){var d=c.error?c.error:c.transaction.error;r(d)}}catch(d){r(d)}})}).catch(r)});return y(o,n),o}function ye(e){var n=this,t=new v(function(o,a){n.ready().then(function(){Z(n._dbInfo,l,function(r,i){if(r)return a(r);try{var s=i.objectStore(n._dbInfo.storeName),u=s.clear();i.oncomplete=function(){o()},i.onabort=i.onerror=function(){var c=u.error?u.error:u.transaction.error;a(c)}}catch(c){a(c)}})}).catch(a)});return y(t,e),t}function pt(e){var n=this,t=new v(function(o,a){n.ready().then(function(){Z(n._dbInfo,re,function(r,i){if(r)return a(r);try{var s=i.objectStore(n._dbInfo.storeName),u=s.count();u.onsuccess=function(){o(u.result)},u.onerror=function(){a(u.error)}}catch(c){a(c)}})}).catch(a)});return y(t,e),t}function yt(e,n){var t=this,o=new v(function(a,r){if(e<0){a(null);return}t.ready().then(function(){Z(t._dbInfo,re,function(i,s){if(i)return r(i);try{var u=s.objectStore(t._dbInfo.storeName),c=!1,d=u.openKeyCursor();d.onsuccess=function(){var m=d.result;if(!m){a(null);return}e===0||c?a(m.key):(c=!0,m.advance(e))},d.onerror=function(){r(d.error)}}catch(m){r(m)}})}).catch(r)});return y(o,n),o}function _t(e){var n=this,t=new v(function(o,a){n.ready().then(function(){Z(n._dbInfo,re,function(r,i){if(r)return a(r);try{var s=i.objectStore(n._dbInfo.storeName),u=s.openKeyCursor(),c=[];u.onsuccess=function(){var d=u.result;if(!d){o(c);return}c.push(d.key),d.continue()},u.onerror=function(){a(u.error)}}catch(d){a(d)}})}).catch(a)});return y(t,e),t}function bt(e,n){n=K.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;if(!e.name)a=v.reject("Invalid arguments");else{var r=e.name===t.name&&o._dbInfo.db,i=r?v.resolve(o._dbInfo.db):N(e).then(function(s){var u=Y[e.name],c=u.forages;u.db=s;for(var d=0;d<c.length;d++)c[d]._dbInfo.db=s;return s});e.storeName?a=i.then(function(s){if(s.objectStoreNames.contains(e.storeName)){var u=s.version+1;f(e);var c=Y[e.name],d=c.forages;s.close();for(var m=0;m<d.length;m++){var I=d[m];I._dbInfo.db=null,I._dbInfo.version=u}var x=new v(function(T,V){var $=k.open(e.name,u);$.onerror=function(ee){var be=$.result;be.close(),V(ee)},$.onupgradeneeded=function(){var ee=$.result;ee.deleteObjectStore(e.storeName)},$.onsuccess=function(){var ee=$.result;ee.close(),T(ee)}});return x.then(function(T){c.db=T;for(var V=0;V<d.length;V++){var $=d[V];$._dbInfo.db=T,g($._dbInfo)}}).catch(function(T){throw(h(e,T)||v.resolve()).catch(function(){}),T})}}):a=i.then(function(s){f(e);var u=Y[e.name],c=u.forages;s.close();for(var d=0;d<c.length;d++){var m=c[d];m._dbInfo.db=null}var I=new v(function(x,T){var V=k.deleteDatabase(e.name);V.onerror=function(){var $=V.result;$&&$.close(),T(V.error)},V.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},V.onsuccess=function(){var $=V.result;$&&$.close(),x($)}});return I.then(function(x){u.db=x;for(var T=0;T<c.length;T++){var V=c[T];g(V._dbInfo)}}).catch(function(x){throw(h(e,x)||v.resolve()).catch(function(){}),x})})}return y(a,n),a}var wt={_driver:"asyncStorage",_initStorage:Ee,_support:C(),iterate:De,getItem:Se,setItem:J,removeItem:fe,clear:ye,length:pt,key:yt,keys:_t,dropInstance:bt};function It(){return typeof openDatabase=="function"}var ae="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Et="~~local_forage_type~",je=/^~~local_forage_type~([^~]+)~/,Re="__lfsc__:",Be=Re.length,Le="arbf",Pe="blob",Ge="si08",He="ui08",Ke="uic8",Qe="si16",Xe="si32",Je="ur16",qe="ui32",Ze="fl32",et="fl64",tt=Be+Le.length,nt=Object.prototype.toString;function rt(e){var n=e.length*.75,t=e.length,o,a=0,r,i,s,u;e[e.length-1]==="="&&(n--,e[e.length-2]==="="&&n--);var c=new ArrayBuffer(n),d=new Uint8Array(c);for(o=0;o<t;o+=4)r=ae.indexOf(e[o]),i=ae.indexOf(e[o+1]),s=ae.indexOf(e[o+2]),u=ae.indexOf(e[o+3]),d[a++]=r<<2|i>>4,d[a++]=(i&15)<<4|s>>2,d[a++]=(s&3)<<6|u&63;return c}function Oe(e){var n=new Uint8Array(e),t="",o;for(o=0;o<n.length;o+=3)t+=ae[n[o]>>2],t+=ae[(n[o]&3)<<4|n[o+1]>>4],t+=ae[(n[o+1]&15)<<2|n[o+2]>>6],t+=ae[n[o+2]&63];return n.length%3===2?t=t.substring(0,t.length-1)+"=":n.length%3===1&&(t=t.substring(0,t.length-2)+"=="),t}function St(e,n){var t="";if(e&&(t=nt.call(e)),e&&(t==="[object ArrayBuffer]"||e.buffer&&nt.call(e.buffer)==="[object ArrayBuffer]")){var o,a=Re;e instanceof ArrayBuffer?(o=e,a+=Le):(o=e.buffer,t==="[object Int8Array]"?a+=Ge:t==="[object Uint8Array]"?a+=He:t==="[object Uint8ClampedArray]"?a+=Ke:t==="[object Int16Array]"?a+=Qe:t==="[object Uint16Array]"?a+=Je:t==="[object Int32Array]"?a+=Xe:t==="[object Uint32Array]"?a+=qe:t==="[object Float32Array]"?a+=Ze:t==="[object Float64Array]"?a+=et:n(new Error("Failed to get type for BinaryArray"))),n(a+Oe(o))}else if(t==="[object Blob]"){var r=new FileReader;r.onload=function(){var i=Et+e.type+"~"+Oe(this.result);n(Re+Pe+i)},r.readAsArrayBuffer(e)}else try{n(JSON.stringify(e))}catch(i){console.error("Couldn't convert value into a JSON string: ",e),n(null,i)}}function Dt(e){if(e.substring(0,Be)!==Re)return JSON.parse(e);var n=e.substring(tt),t=e.substring(Be,tt),o;if(t===Pe&&je.test(n)){var a=n.match(je);o=a[1],n=n.substring(a[0].length)}var r=rt(n);switch(t){case Le:return r;case Pe:return z([r],{type:o});case Ge:return new Int8Array(r);case He:return new Uint8Array(r);case Ke:return new Uint8ClampedArray(r);case Qe:return new Int16Array(r);case Je:return new Uint16Array(r);case Xe:return new Int32Array(r);case qe:return new Uint32Array(r);case Ze:return new Float32Array(r);case et:return new Float64Array(r);default:throw new Error("Unkown type: "+t)}}var Ue={serialize:St,deserialize:Dt,stringToBuffer:rt,bufferToString:Oe};function ot(e,n,t,o){e.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,o)}function Rt(e){var n=this,t={db:null};if(e)for(var o in e)t[o]=typeof e[o]!="string"?e[o].toString():e[o];var a=new v(function(r,i){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(s){return i(s)}t.db.transaction(function(s){ot(s,t,function(){n._dbInfo=t,r()},function(u,c){i(c)})},i)});return t.serializer=Ue,a}function ie(e,n,t,o,a,r){e.executeSql(t,o,a,function(i,s){s.code===s.SYNTAX_ERR?i.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[n.storeName],function(u,c){c.rows.length?r(u,s):ot(u,n,function(){u.executeSql(t,o,a,r)},r)},r):r(i,s)},r)}function xt(e,n){var t=this;e=F(e);var o=new v(function(a,r){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(s){ie(s,i,"SELECT * FROM "+i.storeName+" WHERE key = ? LIMIT 1",[e],function(u,c){var d=c.rows.length?c.rows.item(0).value:null;d&&(d=i.serializer.deserialize(d)),a(d)},function(u,c){r(c)})})}).catch(r)});return y(o,n),o}function Tt(e,n){var t=this,o=new v(function(a,r){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(s){ie(s,i,"SELECT * FROM "+i.storeName,[],function(u,c){for(var d=c.rows,m=d.length,I=0;I<m;I++){var x=d.item(I),T=x.value;if(T&&(T=i.serializer.deserialize(T)),T=e(T,x.key,I+1),T!==void 0){a(T);return}}a()},function(u,c){r(c)})})}).catch(r)});return y(o,n),o}function at(e,n,t,o){var a=this;e=F(e);var r=new v(function(i,s){a.ready().then(function(){n===void 0&&(n=null);var u=n,c=a._dbInfo;c.serializer.serialize(n,function(d,m){m?s(m):c.db.transaction(function(I){ie(I,c,"INSERT OR REPLACE INTO "+c.storeName+" (key, value) VALUES (?, ?)",[e,d],function(){i(u)},function(x,T){s(T)})},function(I){if(I.code===I.QUOTA_ERR){if(o>0){i(at.apply(a,[e,u,t,o-1]));return}s(I)}})})}).catch(s)});return y(r,t),r}function At(e,n,t){return at.apply(this,[e,n,t,1])}function Ct(e,n){var t=this;e=F(e);var o=new v(function(a,r){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(s){ie(s,i,"DELETE FROM "+i.storeName+" WHERE key = ?",[e],function(){a()},function(u,c){r(c)})})}).catch(r)});return y(o,n),o}function Nt(e){var n=this,t=new v(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(i){ie(i,r,"DELETE FROM "+r.storeName,[],function(){o()},function(s,u){a(u)})})}).catch(a)});return y(t,e),t}function Bt(e){var n=this,t=new v(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(i){ie(i,r,"SELECT COUNT(key) as c FROM "+r.storeName,[],function(s,u){var c=u.rows.item(0).c;o(c)},function(s,u){a(u)})})}).catch(a)});return y(t,e),t}function Lt(e,n){var t=this,o=new v(function(a,r){t.ready().then(function(){var i=t._dbInfo;i.db.transaction(function(s){ie(s,i,"SELECT key FROM "+i.storeName+" WHERE id = ? LIMIT 1",[e+1],function(u,c){var d=c.rows.length?c.rows.item(0).key:null;a(d)},function(u,c){r(c)})})}).catch(r)});return y(o,n),o}function Pt(e){var n=this,t=new v(function(o,a){n.ready().then(function(){var r=n._dbInfo;r.db.transaction(function(i){ie(i,r,"SELECT key FROM "+r.storeName,[],function(s,u){for(var c=[],d=0;d<u.rows.length;d++)c.push(u.rows.item(d).key);o(c)},function(s,u){a(u)})})}).catch(a)});return y(t,e),t}function Ot(e){return new v(function(n,t){e.transaction(function(o){o.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(a,r){for(var i=[],s=0;s<r.rows.length;s++)i.push(r.rows.item(s).name);n({db:e,storeNames:i})},function(a,r){t(r)})},function(o){t(o)})})}function Ut(e,n){n=K.apply(this,arguments);var t=this.config();e=typeof e!="function"&&e||{},e.name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o=this,a;return e.name?a=new v(function(r){var i;e.name===t.name?i=o._dbInfo.db:i=openDatabase(e.name,"","",0),e.storeName?r({db:i,storeNames:[e.storeName]}):r(Ot(i))}).then(function(r){return new v(function(i,s){r.db.transaction(function(u){function c(x){return new v(function(T,V){u.executeSql("DROP TABLE IF EXISTS "+x,[],function(){T()},function($,ee){V(ee)})})}for(var d=[],m=0,I=r.storeNames.length;m<I;m++)d.push(c(r.storeNames[m]));v.all(d).then(function(){i()}).catch(function(x){s(x)})},function(u){s(u)})})}):a=v.reject("Invalid arguments"),y(a,n),a}var kt={_driver:"webSQLStorage",_initStorage:Rt,_support:It(),iterate:Tt,getItem:xt,setItem:At,removeItem:Ct,clear:Nt,length:Bt,key:Lt,keys:Pt,dropInstance:Ut};function Ft(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}function it(e,n){var t=e.name+"/";return e.storeName!==n.storeName&&(t+=e.storeName+"/"),t}function Mt(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}function $t(){return!Mt()||localStorage.length>0}function zt(e){var n=this,t={};if(e)for(var o in e)t[o]=e[o];return t.keyPrefix=it(e,n._defaultConfig),$t()?(n._dbInfo=t,t.serializer=Ue,v.resolve()):v.reject()}function Yt(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo.keyPrefix,a=localStorage.length-1;a>=0;a--){var r=localStorage.key(a);r.indexOf(o)===0&&localStorage.removeItem(r)}});return y(t,e),t}function Vt(e,n){var t=this;e=F(e);var o=t.ready().then(function(){var a=t._dbInfo,r=localStorage.getItem(a.keyPrefix+e);return r&&(r=a.serializer.deserialize(r)),r});return y(o,n),o}function Wt(e,n){var t=this,o=t.ready().then(function(){for(var a=t._dbInfo,r=a.keyPrefix,i=r.length,s=localStorage.length,u=1,c=0;c<s;c++){var d=localStorage.key(c);if(d.indexOf(r)===0){var m=localStorage.getItem(d);if(m&&(m=a.serializer.deserialize(m)),m=e(m,d.substring(i),u++),m!==void 0)return m}}});return y(o,n),o}function jt(e,n){var t=this,o=t.ready().then(function(){var a=t._dbInfo,r;try{r=localStorage.key(e)}catch{r=null}return r&&(r=r.substring(a.keyPrefix.length)),r});return y(o,n),o}function Gt(e){var n=this,t=n.ready().then(function(){for(var o=n._dbInfo,a=localStorage.length,r=[],i=0;i<a;i++){var s=localStorage.key(i);s.indexOf(o.keyPrefix)===0&&r.push(s.substring(o.keyPrefix.length))}return r});return y(t,e),t}function Ht(e){var n=this,t=n.keys().then(function(o){return o.length});return y(t,e),t}function Kt(e,n){var t=this;e=F(e);var o=t.ready().then(function(){var a=t._dbInfo;localStorage.removeItem(a.keyPrefix+e)});return y(o,n),o}function Qt(e,n,t){var o=this;e=F(e);var a=o.ready().then(function(){n===void 0&&(n=null);var r=n;return new v(function(i,s){var u=o._dbInfo;u.serializer.serialize(n,function(c,d){if(d)s(d);else try{localStorage.setItem(u.keyPrefix+e,c),i(r)}catch(m){(m.name==="QuotaExceededError"||m.name==="NS_ERROR_DOM_QUOTA_REACHED")&&s(m),s(m)}})})});return y(a,t),a}function Xt(e,n){if(n=K.apply(this,arguments),e=typeof e!="function"&&e||{},!e.name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o=this,a;return e.name?a=new v(function(r){e.storeName?r(it(e,o._defaultConfig)):r(e.name+"/")}).then(function(r){for(var i=localStorage.length-1;i>=0;i--){var s=localStorage.key(i);s.indexOf(r)===0&&localStorage.removeItem(s)}}):a=v.reject("Invalid arguments"),y(a,n),a}var Jt={_driver:"localStorageWrapper",_initStorage:zt,_support:Ft(),iterate:Wt,getItem:Vt,setItem:Qt,removeItem:Kt,clear:Yt,length:Ht,key:jt,keys:Gt,dropInstance:Xt},qt=function(n,t){return n===t||typeof n=="number"&&typeof t=="number"&&isNaN(n)&&isNaN(t)},Zt=function(n,t){for(var o=n.length,a=0;a<o;){if(qt(n[a],t))return!0;a++}return!1},st=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"},_e={},ut={},ve={INDEXEDDB:wt,WEBSQL:kt,LOCALSTORAGE:Jt},en=[ve.INDEXEDDB._driver,ve.WEBSQL._driver,ve.LOCALSTORAGE._driver],xe=["dropInstance"],ke=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(xe),tn={description:"",driver:en.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function nn(e,n){e[n]=function(){var t=arguments;return e.ready().then(function(){return e[n].apply(e,t)})}}function Fe(){for(var e=1;e<arguments.length;e++){var n=arguments[e];if(n)for(var t in n)n.hasOwnProperty(t)&&(st(n[t])?arguments[0][t]=n[t].slice():arguments[0][t]=n[t])}return arguments[0]}var rn=function(){function e(n){L(this,e);for(var t in ve)if(ve.hasOwnProperty(t)){var o=ve[t],a=o._driver;this[t]=a,_e[a]||this.defineDriver(o)}this._defaultConfig=Fe({},tn),this._config=Fe({},this._defaultConfig,n),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if((typeof t>"u"?"undefined":_(t))==="object"){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var o in t){if(o==="storeName"&&(t[o]=t[o].replace(/\W/g,"_")),o==="version"&&typeof t[o]!="number")return new Error("Database version must be a number.");this._config[o]=t[o]}return"driver"in t&&t.driver?this.setDriver(this._config.driver):!0}else return typeof t=="string"?this._config[t]:this._config},e.prototype.defineDriver=function(t,o,a){var r=new v(function(i,s){try{var u=t._driver,c=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver){s(c);return}for(var d=ke.concat("_initStorage"),m=0,I=d.length;m<I;m++){var x=d[m],T=!Zt(xe,x);if((T||t[x])&&typeof t[x]!="function"){s(c);return}}var V=function(){for(var be=function(sn){return function(){var un=new Error("Method "+sn+" is not implemented by the current driver"),ct=v.reject(un);return y(ct,arguments[arguments.length-1]),ct}},Me=0,an=xe.length;Me<an;Me++){var $e=xe[Me];t[$e]||(t[$e]=be($e))}};V();var $=function(be){_e[u]&&console.info("Redefining LocalForage driver: "+u),_e[u]=t,ut[u]=be,i()};"_support"in t?t._support&&typeof t._support=="function"?t._support().then($,s):$(!!t._support):$(!0)}catch(ee){s(ee)}});return P(r,o,a),r},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,o,a){var r=_e[t]?v.resolve(_e[t]):v.reject(new Error("Driver not found."));return P(r,o,a),r},e.prototype.getSerializer=function(t){var o=v.resolve(Ue);return P(o,t),o},e.prototype.ready=function(t){var o=this,a=o._driverSet.then(function(){return o._ready===null&&(o._ready=o._initDriver()),o._ready});return P(a,t,t),a},e.prototype.setDriver=function(t,o,a){var r=this;st(t)||(t=[t]);var i=this._getSupportedDrivers(t);function s(){r._config.driver=r.driver()}function u(m){return r._extend(m),s(),r._ready=r._initStorage(r._config),r._ready}function c(m){return function(){var I=0;function x(){for(;I<m.length;){var T=m[I];return I++,r._dbInfo=null,r._ready=null,r.getDriver(T).then(u).catch(x)}s();var V=new Error("No available storage method found.");return r._driverSet=v.reject(V),r._driverSet}return x()}}var d=this._driverSet!==null?this._driverSet.catch(function(){return v.resolve()}):v.resolve();return this._driverSet=d.then(function(){var m=i[0];return r._dbInfo=null,r._ready=null,r.getDriver(m).then(function(I){r._driver=I._driver,s(),r._wrapLibraryMethodsWithReady(),r._initDriver=c(i)})}).catch(function(){s();var m=new Error("No available storage method found.");return r._driverSet=v.reject(m),r._driverSet}),P(this._driverSet,o,a),this._driverSet},e.prototype.supports=function(t){return!!ut[t]},e.prototype._extend=function(t){Fe(this,t)},e.prototype._getSupportedDrivers=function(t){for(var o=[],a=0,r=t.length;a<r;a++){var i=t[a];this.supports(i)&&o.push(i)}return o},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,o=ke.length;t<o;t++)nn(this,ke[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),on=new rn;A.exports=on},{3:3}]},{},[4])(4)})}(We)),We.exports}var Cn=An();const Ne=cn(Cn);async function gt(E){return new Promise((B,W)=>{const A=new FileReader;A.onload=S=>{var _;(_=S.target)!=null&&_.result?B(S.target.result):W(new Error("Failed to read blob data"))},A.onerror=()=>{W(A.error||new Error("Unknown error occurred"))},A.readAsDataURL(E)})}function Nn(E,B,W,A){const S=new FormData;return S.append("name_token",E),S.append("zone_id",B),S.append("file",W),S.append("labels",A),Sn({url:"/api/file/upload",method:"post",data:S,headers:{"Content-Type":"multipart/form-data"}})}const Bn={class:"take-photos-view"},Ln={class:"camera-container"},Pn={id:"video",playsinline:"",autoplay:""},On={class:"preview-drawer"},Un=["src"],kn={class:"preview-info"},Fn={class:"info-section"},Mn={class:"location-info blur-panel"},$n={class:"info-row"},zn={class:"info-row"},Yn={class:"time-info blur-panel"},Vn={class:"thumbnail-section blur-panel"},Wn={class:"thumbnail-header"},jn={class:"thumbnail-list"},Gn=["onClick"],Hn=["src"],Kn={class:"tags-container blur-panel"},Qn={class:"preview-action-buttons blur-panel"},Xn={class:"bottom-controls"},Jn={class:"thumbnail-section"},qn={class:"thumbnail-header"},Zn={class:"thumbnail-list"},er=["onClick"],tr=["src"],nr={class:"action-buttons"},rr={key:0,class:"upload-progress"},or=ln({__name:"TakePhotosView",setup(E){const B=f=>`${l.value.current}/${l.value.total} (${f}%)`;function W(){if(z.value){const f=v.value.findIndex(g=>g.value===z.value.value);f!==-1&&(f===v.value.length-1?z.value=v.value[0]:z.value=v.value[f+1])}}const A=oe(null),S=oe(!1),_=oe(null),L=Ne.createInstance({driver:Ne.INDEXEDDB,name:"image-storage",storeName:"images"});Ne.setDriver(Ne.INDEXEDDB);const p=oe([]);L.iterate((f,g,h)=>{console.log(f,g,h),f&&p.value.push(f)});const k=oe([]);lt(async()=>{const f=await En();k.value=f});const C=fn(),z=oe(),v=oe([]);async function y(){try{if(console.log("开始获取摄像头设备..."),!navigator.mediaDevices||!navigator.mediaDevices.enumerateDevices)throw console.log("mediaDevices API不可用:",{mediaDevices:!!navigator.mediaDevices,enumerateDevices:!!(navigator.mediaDevices&&navigator.mediaDevices.enumerateDevices)}),new Error("浏览器不支持mediaDevices API");console.log("请求摄像头权限..."),await navigator.mediaDevices.getUserMedia({video:!0}),console.log("摄像头权限获取成功"),console.log("开始枚举设备...");const f=await navigator.mediaDevices.enumerateDevices();console.log("枚举到的所有设备:",f),F(f)}catch(f){console.error("获取摄像头失败:",f),K(f),ne.error("获取摄像头失败，请确保已授予摄像头权限")}}y(),lt(()=>{y()}),dn(z,(f,g)=>{if(f){const h=document.getElementById("video");if(h&&h.srcObject){const b=h.srcObject.getTracks();for(let N=0;N!==b.length;++N)b[N].stop()}navigator.mediaDevices.getUserMedia({video:{deviceId:f.deviceInfo.deviceId}}).then(function(b){const N=document.getElementById("video");N.srcObject=b}).catch(K)}});function P(f){S.value=!0,k.value.forEach(g=>{var h;g.checked=((h=f==null?void 0:f.labels)==null?void 0:h.includes(g.label))||!1}),f!=null&&f.labels?(f.labels=k.value.filter(g=>g.checked).map(g=>g.label),L.setItem(f.id.toString(),Ae(f)).then(()=>{_.value=Ae(f),S.value=!0}).catch(g=>{console.error(g)})):f.labels=[]}function F(f){console.log("开始处理设备列表...");for(let g=0;g!==f.length;++g){const h=f[g];console.log("检查设备:",{kind:h.kind,label:h.label,deviceId:h.deviceId}),h.kind==="videoinput"&&(h.label.toLowerCase().includes("back")||h.label.toLowerCase().includes("后置")||h.label.toLowerCase().includes("rear"))&&(console.log("找到后置摄像头:",h.label),v.value.push({label:h.label||`camera ${v.value.length+1}`,value:h.deviceId,deviceInfo:h}))}if(v.value.length===0){console.log("未找到后置摄像头，添加所有视频输入设备");for(let g=0;g!==f.length;++g){const h=f[g];h.kind==="videoinput"&&(console.log("添加视频输入设备:",h.label),v.value.push({label:h.label||`camera ${v.value.length+1}`,value:h.deviceId,deviceInfo:h}))}}console.log("最终的摄像头列表:",v.value),v.value.length>0?(z.value=v.value[0],console.log("已选择默认摄像头:",z.value)):console.log("警告: 未找到任何可用的摄像头设备")}function K(f){console.log("navigator.MediaDevices.getUserMedia error: ",f.message,f.name),console.error("摄像头错误详情:",{message:f.message,name:f.name,stack:f.stack})}function M(){var g;if(S.value){S.value=!1,z.value=null;return}const f=document.getElementById("video");if(f&&f.srcObject){const h=(g=f==null?void 0:f.srcObject)==null?void 0:g.getVideoTracks()[0];if(h){let b=new ImageCapture(h);const N=ht();b.takePhoto().then(async G=>{const X=await gt(G),q={id:N,dataUrl:X,gps:{accuracy:C.gps.accuracy,coords:{latitude:C.gps.coords.latitude,longitude:C.gps.coords.longitude},timestamp:C.gps.timestamp},shotTime:Date.now(),labels:[]};L.setItem(q.id.toString(),q).then(()=>{console.log("Image stored successfully"),ne({message:"照片已保存",type:"success"}),p.value.push(q),_.value=q,S.value=!0}).catch(Q=>{ne({message:"保存照片失败:"+Q.message,type:"error"})})}).catch(G=>{console.error("takePhoto() error: ",G)})}}}function te(){console.log(_.value),_.value&&L.removeItem(_.value.id.toString()).then(()=>{console.log("Image removed successfully");const f=p.value.findIndex(g=>{var h;return g.id===((h=_.value)==null?void 0:h.id)});f!==-1&&p.value.splice(f,1),ne({message:"照片已删除",type:"success"}),S.value=!1}).catch(f=>{ne.error("删除照片失败:",f)}).finally(()=>{S.value=!1})}const Y=wn(),ge=async f=>{if(f.raw){const g=ht(),h={id:g,dataUrl:await gt(f.raw),gps:{accuracy:C.gps.accuracy,coords:{latitude:C.gps.coords.latitude,longitude:C.gps.coords.longitude},timestamp:C.gps.timestamp},shotTime:Date.now()};L.setItem(g,h),p.value.push(h),_.value=h,S.value=!0}},re=oe(null),l=oe({isUploading:!1,current:0,total:0,success:0,failed:0}),D=async()=>{if(p.value.length===0){ne.warning("没有待上传的图片");return}l.value={isUploading:!0,current:0,total:p.value.length,success:0,failed:0};const f=localStorage.getItem("name_token")||"";if(f===""){ne.warning("获取name_token失败，请从邀请链接访问。");return}const g=Y.currentRoute.value.params.zoneId,h=[...p.value];for(;h.length>0&&l.value.isUploading;){const b=h.shift();if(b){l.value.current++;try{const G=await(await fetch(b.dataUrl)).blob(),X=new File([G],`photo_${b.shotTime}.jpg`,{type:"image/jpeg"}),q=(b.labels||[]).join(",");await Nn(f,g,X,q),await L.removeItem(b.id.toString());const Q=p.value.findIndex(le=>le.id===b.id);Q!==-1&&p.value.splice(Q,1),l.value.success++}catch(N){l.value.failed++,ne.error(`图片 ${l.value.current}/${l.value.total} 上传失败: ${N.message}`),(!b.retryCount||b.retryCount<3)&&(b.retryCount=(b.retryCount||0)+1,h.push(b))}}}l.value.isUploading=!1,l.value.success>0&&ne.success(`上传完成！成功：${l.value.success}，失败：${l.value.failed}`),S.value=!1},w=async(f,g)=>{if(f.checked=g,f=Ae(f),!!f&&_.value){_.value.labels=k.value.filter(h=>h.checked).map(h=>h.label);try{const h=_.value.id.toString(),b=Ae(_.value);await L.setItem(h,b);const N=p.value.findIndex(G=>{var X;return G.id===((X=_.value)==null?void 0:X.id)});N!==-1&&(p.value[N]=_.value)}catch(h){console.log(h),ne.error("标签更新失败: "+h)}}};function R(){const f=A.value;f&&(document.fullscreenElement?document.exitFullscreen():f.requestFullscreen())}return(f,g)=>{var Q,le,we,Ie,Z,pe,Ee,Se,De;const h=he("el-button"),b=he("el-icon"),N=he("el-check-tag"),G=he("el-popconfirm"),X=he("el-upload"),q=he("el-progress");return ce(),se("div",Bn,[O("div",Ln,[ft(O("video",Pn,null,512),[[dt,!S.value]]),U(h,{class:"camera-select",icon:de(vn),circle:"",onClick:W},null,8,["icon"])]),ft(O("div",On,[O("img",{class:"preview-image",ref_key:"imgdrawer",ref:A,onClick:R,src:(Q=_.value)==null?void 0:Q.dataUrl,alt:""},null,8,Un),O("div",kn,[O("div",Fn,[O("div",Mn,[O("div",$n,"纬度: "+ue((Ie=(we=(le=_.value)==null?void 0:le.gps)==null?void 0:we.coords)==null?void 0:Ie.latitude),1),O("div",zn,"经度: "+ue((Ee=(pe=(Z=_.value)==null?void 0:Z.gps)==null?void 0:pe.coords)==null?void 0:Ee.longitude),1)]),O("div",Yn,"GPS Time: "+ue((De=(Se=_.value)==null?void 0:Se.gps)==null?void 0:De.timestamp),1),U(h,{class:"fullscreen-btn",type:"primary",circle:"",onClick:R},{default:H(()=>[U(b,null,{default:H(()=>[U(de(mn))]),_:1})]),_:1})]),O("div",null,[O("div",Vn,[O("div",Wn,"待上传列表 ("+ue(p.value.length)+")",1),O("div",jn,[(ce(!0),se(ze,null,Ye(p.value,(J,fe)=>(ce(),se("div",{key:fe,class:"thumbnail-item",onClick:ye=>P(J)},[O("img",{src:J.dataUrl,alt:"photo",class:"thumbnail-image"},null,8,Hn)],8,Gn))),128))])]),O("div",Kn,[(ce(!0),se(ze,null,Ye(k.value,(J,fe)=>(ce(),se("div",{key:fe,class:"tag-item"},[U(N,{checked:J.checked,onChange:ye=>w(J,ye)},{default:H(()=>[me(ue(J.checked?"✓":"")+" "+ue(J.label),1)]),_:2},1032,["checked","onChange"])]))),128))]),O("div",Qn,[U(G,{title:"确认删除?",onConfirm:te},{reference:H(()=>[U(h,{class:"preview-btn",type:"danger",round:"",size:"small"},{default:H(()=>[U(b,null,{default:H(()=>[U(de(gn))]),_:1}),g[1]||(g[1]=me(" 删除 "))]),_:1})]),_:1}),U(h,{class:"preview-btn",type:"success",round:"",size:"small",onClick:D,loading:l.value.isUploading},{default:H(()=>[U(b,null,{default:H(()=>[U(de(pn))]),_:1}),me(" "+ue(l.value.isUploading?"上传中...":"上传"),1)]),_:1},8,["loading"]),U(h,{class:"preview-btn",type:"info",round:"",size:"small",onClick:g[0]||(g[0]=J=>S.value=!1)},{default:H(()=>[U(b,null,{default:H(()=>[U(de(yn))]),_:1}),g[2]||(g[2]=me(" 返回 "))]),_:1})])])])],512),[[dt,S.value]]),O("div",Xn,[O("div",Jn,[O("div",qn,"待上传列表 ("+ue(p.value.length)+")",1),O("div",Zn,[(ce(!0),se(ze,null,Ye(p.value,(J,fe)=>(ce(),se("div",{key:fe,class:"thumbnail-item",onClick:ye=>P(J)},[O("img",{src:J.dataUrl,alt:"photo",class:"thumbnail-image"},null,8,tr)],8,er))),128))])]),O("div",nr,[U(h,{class:"action-btn camera-btn",type:"danger",round:"",size:"large",onClick:M},{default:H(()=>[U(b,null,{default:H(()=>[U(de(_n))]),_:1}),g[3]||(g[3]=me(" 拍照 "))]),_:1}),U(X,{ref_key:"upload",ref:re,"show-file-list":!1,class:"action-btn select-btn",accept:"image/jpeg, image/png, image/gif, image/*",action:"",limit:1,onChange:ge,"auto-upload":!1},{trigger:H(()=>[U(h,{type:"primary",round:"",size:"large"},{default:H(()=>[U(b,null,{default:H(()=>[U(de(bn))]),_:1}),g[4]||(g[4]=me(" 选择照片 "))]),_:1})]),_:1},512)]),l.value.isUploading?(ce(),se("div",rr,[U(q,{percentage:Math.floor(l.value.current/l.value.total*100),format:B,"stroke-width":8},null,8,["percentage"])])):hn("",!0)])])}}}),cr=In(or,[["__scopeId","data-v-a7c9a196"]]);export{cr as default};
