import{g as U,u as $,a as q,d as R}from"./zone-juNtbP36.js";import{d as S,P as A,x as c,o as G,k as O,i as w,z as P,g as o,t as m,u as l,a as t,C as i,T as j,c as H,p as _,G as p,U as J,f as x,_ as K}from"./index-D8SYNlsh.js";const Q={class:"zone-container"},W={class:"header"},X=S({__name:"index",setup(Y){const{t:e}=A(),g=c(!1),b=c(!1),d=c(!1),v=c(!1),h=c([]),u=c(),s=c({id:0,name:""}),C={name:[{required:!0,message:e("validation.required"),trigger:"blur"}]},y=async()=>{try{g.value=!0;const n=await U();h.value=n}catch(n){console.error("Failed to fetch zones:",n)}finally{g.value=!1}},k=()=>{v.value=!1,s.value={id:0,name:""},d.value=!0},V=n=>{v.value=!0,s.value={...n},d.value=!0},Z=async()=>{u.value&&await u.value.validate(async n=>{if(n)try{b.value=!0,v.value?(await $(s.value.id,s.value.name),p.success(e("common.success"))):(await q(s.value.name),p.success(e("common.success"))),d.value=!1,y()}catch(a){console.error("Operation failed:",a),p.error(e("common.error"))}finally{b.value=!1}})},B=async n=>{try{await J.confirm(e("zone.deleteConfirm"),e("common.tip"),{confirmButtonText:e("common.confirm"),cancelButtonText:e("common.cancel"),type:"warning"}),await R(n.id),p.success(e("common.success")),y()}catch(a){a!=="cancel"&&(console.error("Failed to delete zone:",a),p.error(e("common.error")))}},D=()=>{u.value&&u.value.resetFields()};return G(()=>{y()}),(n,a)=>{const f=i("el-button"),z=i("el-table-column"),E=i("el-table"),N=i("el-input"),F=i("el-form-item"),L=i("el-form"),M=i("el-dialog"),T=j("loading");return x(),O("div",Q,[w("div",W,[w("h2",null,m(l(e)("zone.zoneManagement")),1),o(f,{type:"primary",onClick:k},{default:t(()=>[_(m(l(e)("zone.addZone")),1)]),_:1})]),P((x(),H(E,{data:h.value,border:"",style:{width:"100%"}},{default:t(()=>[o(z,{prop:"id",label:"ID",width:"80"}),o(z,{prop:"name",label:l(e)("zone.zoneName")},null,8,["label"]),o(z,{label:l(e)("common.operation"),width:"200"},{default:t(({row:r})=>[o(f,{type:"primary",size:"small",onClick:I=>V(r)},{default:t(()=>[_(m(l(e)("common.edit")),1)]),_:2},1032,["onClick"]),o(f,{type:"danger",size:"small",onClick:I=>B(r)},{default:t(()=>[_(m(l(e)("common.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[T,g.value]]),o(M,{modelValue:d.value,"onUpdate:modelValue":a[2]||(a[2]=r=>d.value=r),title:v.value?l(e)("zone.editZone"):l(e)("zone.addZone"),width:"500px",onClose:D},{footer:t(()=>[o(f,{onClick:a[1]||(a[1]=r=>d.value=!1)},{default:t(()=>[_(m(l(e)("common.cancel")),1)]),_:1}),o(f,{type:"primary",onClick:Z,loading:b.value},{default:t(()=>[_(m(l(e)("common.confirm")),1)]),_:1},8,["loading"])]),default:t(()=>[o(L,{ref_key:"formRef",ref:u,model:s.value,rules:C,"label-width":"100px"},{default:t(()=>[o(F,{label:l(e)("zone.zoneName"),prop:"name"},{default:t(()=>[o(N,{modelValue:s.value.name,"onUpdate:modelValue":a[0]||(a[0]=r=>s.value.name=r)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),ae=K(X,[["__scopeId","data-v-da9c25bf"]]);export{ae as default};
