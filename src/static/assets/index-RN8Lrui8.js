import{g as M,u as N,a as R,d as T}from"./zone-ce2pcvkT.js";import{d as I,x as s,o as S,k as U,i as b,z as q,g as a,a as t,C as i,R as A,c as G,p as c,G as g,S as O,f as x,_ as j}from"./index-csrz31wk.js";const H={class:"zone-container"},J={class:"header"},K=I({__name:"index",setup(P){const f=s(!1),v=s(!1),r=s(!1),m=s(!1),y=s([]),d=s(),o=s({id:0,name:""}),k={name:[{required:!0,message:"请输入区域名称",trigger:"blur"}]},p=async()=>{try{f.value=!0;const l=await M();y.value=l}catch(l){console.error("Failed to fetch zones:",l)}finally{f.value=!1}},w=()=>{m.value=!1,o.value={id:0,name:""},r.value=!0},C=l=>{m.value=!0,o.value={...l},r.value=!0},V=async()=>{d.value&&await d.value.validate(async l=>{if(l)try{v.value=!0,m.value?(await N(o.value.id,o.value.name),g.success("更新成功")):(await R(o.value.name),g.success("添加成功")),r.value=!1,p()}catch(e){console.error("Operation failed:",e)}finally{v.value=!1}})},z=async l=>{try{await O.confirm(`确定要删除区域 "${l.name}" 吗？`,"警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await T(l.id),g.success("删除成功"),p()}catch(e){e!=="cancel"&&console.error("Failed to delete zone:",e)}},B=()=>{d.value&&d.value.resetFields()};return S(()=>{p()}),(l,e)=>{const u=i("el-button"),_=i("el-table-column"),E=i("el-table"),Z=i("el-input"),D=i("el-form-item"),F=i("el-form"),L=i("el-dialog"),$=A("loading");return x(),U("div",H,[b("div",J,[e[4]||(e[4]=b("h2",null,"区域管理",-1)),a(u,{type:"primary",onClick:w},{default:t(()=>e[3]||(e[3]=[c("添加区域")])),_:1})]),q((x(),G(E,{data:y.value,border:"",style:{width:"100%"}},{default:t(()=>[a(_,{prop:"id",label:"ID",width:"80"}),a(_,{prop:"name",label:"区域名称"}),a(_,{label:"操作",width:"200"},{default:t(({row:n})=>[a(u,{type:"primary",size:"small",onClick:h=>C(n)},{default:t(()=>e[5]||(e[5]=[c(" 编辑 ")])),_:2},1032,["onClick"]),a(u,{type:"danger",size:"small",onClick:h=>z(n)},{default:t(()=>e[6]||(e[6]=[c(" 删除 ")])),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[$,f.value]]),a(L,{modelValue:r.value,"onUpdate:modelValue":e[2]||(e[2]=n=>r.value=n),title:m.value?"编辑区域":"添加区域",width:"500px",onClose:B},{footer:t(()=>[a(u,{onClick:e[1]||(e[1]=n=>r.value=!1)},{default:t(()=>e[7]||(e[7]=[c("取消")])),_:1}),a(u,{type:"primary",onClick:V,loading:v.value},{default:t(()=>e[8]||(e[8]=[c(" 确定 ")])),_:1},8,["loading"])]),default:t(()=>[a(F,{ref_key:"formRef",ref:d,model:o.value,rules:k,"label-width":"100px"},{default:t(()=>[a(D,{label:"区域名称",prop:"name"},{default:t(()=>[a(Z,{modelValue:o.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>o.value.name=n)},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}}),X=j(K,[["__scopeId","data-v-29fc2117"]]);export{X as default};
